#pragma once

#define ARM_MATH_CM0PLUS
#include <arm_math.h>

///// MICROPHONE PROPERTIES (INVENSENSE)

const int BIT_LENGTH = 24;
const int FULL_SCALE_DBSPL = 120; // FULL SCALE dBSPL (AOP = 116dB SPL)
const double FULL_SCALE_DBFS = 20*log10(pow(2,(BIT_LENGTH)));
const double RMS_HANN = 0.61177;
const int CONST_FACTOR = 8; // IF change this, change window_reduced
const int NOISE_FACTOR = 2;

///// WEIGHTING TABLES

//Table for 44100Hz and 256 spectrumSize (512 fftSize)

  #define WEIGHTINGTA_44100Hz_256 {0,0.0862538915555343,0.239252440067295,0.381499718566378,0.506174881840981,0.613491046469462,0.704657091342527,0.781358835632495,0.845492532387227,0.898943803532723,0.943446758613464,0.980518052821849,1.011442168756,1.03728522618051,1.05892148026641,1.07706317893995,1.09228900743996,1.10506909425038,1.11578603774419,1.12475213161783,1.13222326008119,1.13841000815891,1.14348650518794,1.14759745249792,1.15086370996276,1.15338674443019,1.15525218115916,1.15653264835139,1.15729006385055,1.15757748064798,1.15744058242197,1.15691890053426,1.15604680851176,1.15485433808098,1.15336785152296,1.15161059787385,1.14960317484241,1.14736391388858,1.144909202431,1.14225375441076,1.13941083827188,1.13639246969807,1.13320957507457,1.12987213054712,1.12638928067012,1.12276943992611,1.1190203798254,1.11514930382876,1.11116291195666,1.10706745663856,1.10286879110129,1.09857241138616,1.09418349291168,1.08970692235556,1.08514732551056,1.08050909166977,1.07579639501394,1.0710132134039,1.06616334492279,1.0612504224636,1.05627792661571,1.05124919706901,1.04616744272406,1.04103575067143,1.03585709418121,1.03063433982534,1.02537025383928,1.02006750781565,1.0147286838109,1.00935627893557,1.00395270948995,0.998520314699319,0.99306136009617,0.987578040591138,0.982072483269213,0.976546749943447,0.971002839494508,0.965442690021033,0.959868180822797,0.954281134236092,0.948683317338438,0.943076443537719,0.937462174059082,0.931842119341346,0.92621784035331,0.920590849839106,0.914962613500672,0.909334551124467,0.903708037658683,0.898084404246482,0.892464939220101,0.886850889060089,0.881243459323409,0.875643815543675,0.870053084106385,0.864472353101651,0.858902673156583,0.853345058249221,0.847800486505647,0.842269900981679,0.836754210430351,0.83125429005623,0.825770982257424,0.820305097356057,0.814857414317805,0.809428681461038,0.804019617155993,0.79863091051432,0.793263222069304,0.787917184446967,0.782593403028247,0.777292456602357,0.772014898011446,0.766761254786601,0.761532029775251,0.756327701759963,0.751148726068651,0.745995535176175,0.740868539297297,0.735768126970984,0.730694665635993,0.725648502197718,0.720629963586252,0.715639357305606,0.710676971974081,0.705743077855713,0.700837927382786,0.695961755669379,0.691114781015906,0.686297205404659,0.681509214986311,0.676750980557397,0.672022658028753,0.667324388884942,0.662656300634656,0.658018507252134,0.653411109609613,0.648834195900849,0.644287842055744,0.639772112146134,0.635287058782778,0.63083272350362,0.626409137153377,0.622016320254532,0.617654283369795,0.613323027456127,0.609022544210399,0.60475281640678,0.600513818225947,0.596305515576211,0.592127866406669,0.587980821012465,0.583864322332297,0.579778306238247,0.575722701818072,0.571697431650051,0.567702412070528,0.563737553434233,0.559802760367541,0.555897932014755,0.552022962277563,0.54817774004777,0.544362149433441,0.540576069978573,0.536819376876427,0.533091941176635,0.529393629986214,0.52572430666461,0.522083831012889,0.518472059457211,0.5148888452267,0.511334038525829,0.507807486701459,0.504309034404633,0.500838523747253,0.497395794453758,0.493980684007924,0.490593027794891,0.487232659238545,0.483899409934353,0.480593109777784,0.477313587088399,0.474060668729743,0.470834180225132,0.467633945869448,0.464459788837038,0.461311531285828,0.45818899445774,0.455091998775533,0.45202036393613,0.448973909000568,0.445952452480626,0.442955812422246,0.439983806485832,0.437036252023507,0.434112966153428,0.431213765831224,0.428338467918663,0.42548688924961,0.422658846693364,0.419854157215444,0.417072637935918,0.41431410618532,0.411578379558249,0.408865275964721,0.406174613679325,0.403506211388266,0.400859888234358,0.398235463860026,0.395632758448378,0.39305159276242,0.390491788182462,0.387953166741769,0.385435551160528,0.382938764878175,0.380462632084138,0.378006977747047,0.375571627642463,0.373156408379176,0.370761147424114,0.368385673125924,0.366029814737245,0.363693402435748,0.36137626734396,0.359078241547929,0.356799158114758,0.354538851109067,0.352297155608395,0.350073907717599,0.347868944582282,0.345682104401278,0.343513226438233,0.341362151032316,0.339228719608089,0.337112774684568,0.335014159883506,0.332932719936925,0.330868300693929,0.32882074912682,0.326789913336546,0.324775642557513,0.322777787161772,0.32079619866262,0.318830729717626,0.316881234131118,0.314947566856136,0.313029583995888,0.31112714280472,0.309240101688628,0.307368320205317,0.305511659063845,0.303669980123854,0.301843146394414,0.30003102203249,0.298233472341061,0.29645036376689,0.294681563897973}
  #define WEIGHTINGTC_44100Hz_256 {0,0.952628134952832,0.992767364583671,1.00035430484132,1.00277562043501,1.00361283564517,1.0037631041543,1.00353597886827,1.00306143427889,1.00240194293949,1.00159071733807,1.00064689017988,0.999582257249026,0.998404545265,0.997119109928524,0.995729870037116,0.994239846333974,0.992651485035501,0.990966858798191,0.989187795227597,0.987315961107345,0.985352918765801,0.98330016444933,0.981159154801695,0.978931325314663,0.976618103254758,0.974220916723174,0.971741200965762,0.969180402699053,0.966539982986071,0.963821419039575,0.961026205223628,0.958155853450507,0.955211893118062,0.952195870695709,0.949109349040722,0.945953906507166,0.942731135895601,0.939442643281183,0.936090046749816,0.932674975066071,0.929199066291959,0.925663966372134,0.922071327698301,0.91842280766347,0.914720067214922,0.910964769413382,0.907158578004741,0.903303156009766,0.89940016433641,0.895451260418736,0.891458096885871,0.887422320263952,0.883345569713601,0.8792294758051,0.875075659333126,0.870885730172598,0.866661286176942,0.862403912119845,0.858115178681348,0.853796641478933,0.849449840144076,0.845076297444583,0.840677518452865,0.836254989760153,0.831810178736554,0.827344532836699,0.822859478950635,0.818356422799508,0.813836748375498,0.809301817425351,0.80475296897682,0.800191518907207,0.795618759553167,0.791035959360859,0.786444362575474,0.781845188969146,0.777239633606173,0.772628866644485,0.768014033172213,0.763396253078245,0.758776620955586,0.754156206036345,0.749536052157167,0.744917177753896,0.740300575884273,0.735687214277464,0.731078035409214,0.726473956601424,0.721875870144974,0.717284643444607,0.712701119184713,0.708126115514862,0.703560426253966,0.699004821111946,0.694460045927822,0.689926822923172,0.685405850969895,0.680897805871282,0.676403340655403,0.671923085879834,0.667457649946813,0.663007619427899,0.658573559397277,0.654156013772843,0.649755505664278,0.645372537727292,0.641007592523321,0.636661132883915,0.63233360227914,0.628025425189332,0.623737007479544,0.619468736776102,0.615220982844674,0.61099409796931,0.606788417331926,0.602604259391733,0.598441926264149,0.594301704098744,0.590183863455803,0.586088659681111,0.582016333278595,0.57796711028047,0.57394120261458,0.569938808468608,0.565960112650905,0.562005286947654,0.558074490476144,0.554167870033922,0.550285560443631,0.546427684893348,0.54259435527224,0.538785672501405,0.535001726859754,0.531242598304806,0.527508356788298,0.523799062566514,0.520114766505241,0.516455510379307,0.512821327166611,0.509212241336624,0.505628269133322,0.5020694188525,0.498535691113488,0.495027079125224,0.491543568946709,0.488085139741838,0.484651764028622,0.481243407922828,0.477860031376062,0.474501588408317,0.471168027335048,0.46785929098879,0.464575316935388,0.461316037684885,0.458081380897112,0.454871269582063,0.4516856222951,0.448524353327059,0.44538737288933,0.442274587293972,0.43918589912895,0.43612120742856,0.433080407839119,0.43006339278,0.427070051600096,0.424100270729787,0.42115393382849,0.418230921927885,0.415331113570892,0.412454384946474,0.409600610020372,0.406769660661833,0.403961406766419,0.401175716374998,0.398412455788974,0.395671489681853,0.39295268120723,0.39025589210327,0.387580982793766,0.384927812485857,0.382296239264488,0.379686120183677,0.377097311354694,0.374529668031192,0.371983044691396,0.369457295117419,0.366952272471763,0.364467829371096,0.362003817957369,0.359560089966342,0.357136496793595,0.35473288955808,0.352349119163295,0.34998503635614,0.34764049178351,0.345315336046708,0.343009419753721,0.340722593569432,0.338454708263821,0.336205614758216,0.333975164169656,0.331763207853403,0.329569597443691,0.327394184892727,0.325236822508024,0.32309736298811,0.320975659456653,0.318871565495064,0.316784935173621,0.314715623081152,0.312663484353336,0.310628374699657,0.308610150429057,0.306608668474327,0.304623786415283,0.302655362500762,0.300703255669473,0.298767325569752,0.296847432578245,0.294943437817568,0.293055203172963,0.291182591308001,0.289325465679349,0.287483690550645,0.285657131005505,0.283845652959697,0.282049123172506,0.280267409257324,0.278500379691491,0.276747903825408,0.275009851890959,0.273286095009261,0.271576505197766,0.269880955376737,0.268199319375133,0.266531471935908,0.26487728872076,0.263236646314347,0.261609422227984,0.259995494902851,0.258394743712725,0.25680704896626,0.25523229190882,0.253670354723905,0.252121120534161,0.250584473402015,0.249060298329932,0.247548481260319,0.246048909075089,0.244561469594897,0.243086051578072,0.241622544719237,0.240170839647657,0.238730827925309,0.237302402044688,0.235885455426371}

//To be applied in the non-DB spectrum
const double A_WEIGHTINGTAB[] = WEIGHTINGTA_44100Hz_256;
const double C_WEIGHTINGTAB[] = WEIGHTINGTC_44100Hz_256; //JUST FOR NOW

///// HANN WINDOW

//Table for 512 sample size

  #define HANN_WINDOW_512 {0,0.0000377965772740962,0.000151180594771427,0.000340134910380874,0.000604630956796859,0.000944628745838338,0.00136007687449447,0.00185091253269609,0.00241706151281168,0.00305843822086654,0.00377494568948339,0.00456647559254264,0.00543290826155973,0.0063741127037773,0.00738994662196968,0.00848025643595607,0.00964487730581998,0.0108836331568305,0.0121963367060627,0.0135827894907121,0.0150427818980994,0.0165760931973613,0.0181824915728215,0.019861734159039,0.0216135670775249,0.0234377254751261,0.0253339335640674,0.0273019046636466,0.0293413412435765,0.0314519349689681,0.033633366746946,0.0358853067748912,0.0382074145903025,0.0405993391222701,0.0430607187445522,0.0455911813302485,0.0481903443080604,0.0508578147201305,0.0535931892814526,0.0563960544408427,0.0592659864434626,0.0622025513948853,0.0652053053266945,0.0682737942636061,0.0714075542921032,0.0746061116305735,0.0778689827009385,0.0811956742017641,0.0845856831828408,0.0880384971212229,0.091553593998715,0.0951304423807943,0.0987685014969555,0.102467221322468,0.106226042661535,0.110044397231829,0.113921707750418,0.117857388021034,0.121850843022703,0.125901468999704,0.130008653552846,0.134171775732054,0.138390206130252,0.14266330697852,0.146990432242509,0.151370927720124,0.15580413114042,0.160289372263735,0.164825972983019,0.169413247426352,0.174050502060644,0.17873703579648,0.183472140094124,0.188255099070633,0.193085189608094,0.197961681462944,0.20288383737638,0.207850913185816,0.212862157937393,0.217916813999513,0.223014117177383,0.228153296828549,0.233333575979408,0.238554171442674,0.243814293935788,0.249113148200246,0.254449933121827,0.259823841851719,0.265234061928494,0.270679775400948,0.276160158951759,0.281674384021968,0.287221616936238,0.292801019028898,0.29841174677074,0.304052951896545,0.309723781533331,0.315423378329296,0.321150880583437,0.326905422375828,0.332686133698534,0.338492140587147,0.344322565252915,0.350176526215451,0.356053138436005,0.361951513451266,0.367870759507683,0.373809981696295,0.379768282088018,0.385744759869409,0.391738511478851,0.397748630743159,0.403774209014585,0.40981433530819,0.415868096439573,0.421934577162933,0.42801286030944,0.434102026925899,0.440201156413684,0.446309326667918,0.452425614216887,0.45854909436165,0.464678841315845,0.470813928345655,0.476953427909915,0.483096411800347,0.489241951281889,0.49538911723311,0.501536980286678,0.507684610969869,0.513831079845091,0.5199754576504,0.526116815439995,0.532254224724658,0.538386757612132,0.544513486947405,0.550633486452881,0.556745830868423,0.56284959609124,0.568943859315595,0.575027699172326,0.581100195868139,0.587160431324672,0.593207489317293,0.599240455613625,0.605258418111759,0.611260466978157,0.617245694785205,0.623213196648401,0.629162070363163,0.635091416541232,0.641000338746643,0.646887943631258,0.652753341069825,0.658595644294553,0.664413970029181,0.670207438622517,0.675975174181427,0.68171630470326,0.687429962207682,0.693115282867903,0.698771407141278,0.704397479899253,0.709992650556653,0.715556073200279,0.721086906716794,0.726584314919893,0.73204746667672,0.737475536033525,0.742867702340536,0.748223150376032,0.75354107046959,0.7588206586245,0.764061116639314,0.769261652228528,0.774421479142359,0.779539817285623,0.784615892835666,0.789648938359361,0.794638192929131,0.799582902237994,0.804482318713598,0.809335701631252,0.814142317225904,0.818901438803083,0.823612346848765,0.828274329138148,0.832886680843338,0.837448704639903,0.841959710812305,0.84641901735817,0.850825950091399,0.855179842744098,0.859480037067308,0.86372588293052,0.867916738419968,0.87205196993568,0.876130952287265,0.880153068788438,0.884117711350248,0.888024280573021,0.891872185836974,0.895660845391512,0.899389686443183,0.903058145242268,0.906665667168023,0.910211706812523,0.913695728063121,0.917117204183505,0.920475617893327,0.923770461446416,0.927001236707534,0.930167455227694,0.933268638318005,0.936304317122042,0.93927403268673,0.942177336031735,0.945013788217338,0.947782960410804,0.95048443395121,0.95311780041274,0.955682661666441,0.958178629940404,0.960605327878401,0.962962388596925,0.965249455740667,0.967466183536386,0.969612236845188,0.971687291213196,0.973691032920597,0.97562315902908,0.977483377427628,0.979271406876687,0.980986977050686,0.9826298285789,0.984199713084672,0.985696393222957,0.987119642716209,0.988469246388591,0.989745000198504,0.990946711269438,0.992074197919133,0.993127289687043,0.99410582736011,0.995009662996835,0.995838659949645,0.99659269288555,0.997271647805093,0.997875422059586,0.998403924366628,0.998857074823906,0.999234804921275,0.999537057551115,0.999763787016967,0.99991495904044,0.999990550766393,0.999990550766393,0.99991495904044,0.999763787016967,0.999537057551115,0.999234804921275,0.998857074823906,0.998403924366628,0.997875422059586,0.997271647805093,0.99659269288555,0.995838659949645,0.995009662996835,0.99410582736011,0.993127289687043,0.992074197919133,0.990946711269438,0.989745000198504,0.988469246388591,0.987119642716209,0.985696393222957,0.984199713084672,0.9826298285789,0.980986977050686,0.979271406876687,0.977483377427628,0.97562315902908,0.973691032920598,0.971687291213196,0.969612236845189,0.967466183536386,0.965249455740667,0.962962388596925,0.960605327878401,0.958178629940405,0.955682661666441,0.95311780041274,0.95048443395121,0.947782960410804,0.945013788217338,0.942177336031735,0.93927403268673,0.936304317122042,0.933268638318005,0.930167455227694,0.927001236707534,0.923770461446416,0.920475617893328,0.917117204183505,0.913695728063121,0.910211706812523,0.906665667168023,0.903058145242268,0.899389686443183,0.895660845391512,0.891872185836974,0.888024280573021,0.884117711350248,0.880153068788438,0.876130952287266,0.87205196993568,0.867916738419968,0.86372588293052,0.859480037067308,0.855179842744099,0.850825950091399,0.84641901735817,0.841959710812305,0.837448704639903,0.832886680843338,0.828274329138148,0.823612346848765,0.818901438803083,0.814142317225904,0.809335701631252,0.804482318713599,0.799582902237994,0.794638192929131,0.789648938359361,0.784615892835666,0.779539817285623,0.77442147914236,0.769261652228528,0.764061116639314,0.7588206586245,0.753541070469591,0.748223150376032,0.742867702340537,0.737475536033525,0.73204746667672,0.726584314919893,0.721086906716794,0.715556073200279,0.709992650556654,0.704397479899253,0.698771407141278,0.693115282867903,0.687429962207682,0.681716304703259,0.675975174181427,0.670207438622517,0.664413970029181,0.658595644294553,0.652753341069825,0.646887943631258,0.641000338746643,0.635091416541232,0.629162070363163,0.6232131966484,0.617245694785205,0.611260466978157,0.605258418111759,0.599240455613625,0.593207489317293,0.587160431324672,0.581100195868139,0.575027699172326,0.568943859315596,0.56284959609124,0.556745830868423,0.550633486452881,0.544513486947404,0.538386757612132,0.532254224724658,0.526116815439995,0.5199754576504,0.513831079845091,0.507684610969869,0.501536980286678,0.49538911723311,0.489241951281889,0.483096411800347,0.476953427909915,0.470813928345655,0.464678841315845,0.45854909436165,0.452425614216887,0.446309326667919,0.440201156413684,0.434102026925899,0.42801286030944,0.421934577162933,0.415868096439574,0.40981433530819,0.403774209014585,0.397748630743159,0.391738511478851,0.385744759869409,0.379768282088018,0.373809981696295,0.367870759507684,0.361951513451266,0.356053138436005,0.350176526215452,0.344322565252915,0.338492140587147,0.332686133698534,0.326905422375828,0.321150880583437,0.315423378329297,0.309723781533332,0.304052951896545,0.29841174677074,0.292801019028898,0.287221616936238,0.281674384021968,0.276160158951759,0.270679775400947,0.265234061928494,0.259823841851719,0.254449933121828,0.249113148200245,0.243814293935788,0.238554171442674,0.233333575979408,0.228153296828549,0.223014117177384,0.217916813999514,0.212862157937393,0.207850913185816,0.20288383737638,0.197961681462944,0.193085189608094,0.188255099070633,0.183472140094124,0.17873703579648,0.174050502060644,0.169413247426353,0.164825972983019,0.160289372263735,0.15580413114042,0.151370927720124,0.146990432242509,0.14266330697852,0.138390206130252,0.134171775732054,0.130008653552846,0.125901468999704,0.121850843022703,0.117857388021034,0.113921707750418,0.11004439723183,0.106226042661535,0.102467221322469,0.0987685014969556,0.0951304423807942,0.091553593998715,0.0880384971212229,0.0845856831828409,0.0811956742017641,0.0778689827009387,0.0746061116305735,0.0714075542921033,0.068273794263606,0.0652053053266948,0.0622025513948854,0.0592659864434625,0.0563960544408427,0.0535931892814527,0.0508578147201306,0.0481903443080604,0.0455911813302486,0.0430607187445523,0.0405993391222702,0.0382074145903025,0.0358853067748913,0.0336333667469461,0.031451934968968,0.0293413412435765,0.0273019046636465,0.0253339335640675,0.0234377254751261,0.0216135670775249,0.0198617341590389,0.0181824915728217,0.0165760931973613,0.0150427818980994,0.0135827894907122,0.0121963367060628,0.0108836331568306,0.00964487730581992,0.00848025643595618,0.00738994662196968,0.00637411270377736,0.00543290826155973,0.00456647559254275,0.00377494568948344,0.00305843822086654,0.00241706151281168,0.00185091253269615,0.00136007687449447,0.000944628745838338,0.000604630956796859,0.000340134910380874,0.000151180594771427,0.0000377965772740962,0}
  
const double HANN[] = HANN_WINDOW_512;

	#define HANN_WINDOW_512_REDUCED {0,0.00000472457215926203,0.0000188975743464284,0.0000425168637976092,0.0000755788695996074,0.000118078593229792,0.000170009609311808,0.000231364066587011,0.00030213268910146,0.000382304777608318,0.000471868211185424,0.00057080944906783,0.000679113532694967,0.000796764087972163,0.00092374332774621,0.00106003205449451,0.0012056096632275,0.00136045414460381,0.00152454208825784,0.00169784868633902,0.00188034773726243,0.00207201164967016,0.00227281144660269,0.00248271676987987,0.00270169588469061,0.00292971568439077,0.00316674169550843,0.00341273808295582,0.00366766765544706,0.00393149187112101,0.00420417084336825,0.0044856633468614,0.00477592682378782,0.00507491739028376,0.00538258984306903,0.00569889766628107,0.00602379303850755,0.00635722684001631,0.00669914866018157,0.00704950680510534,0.00740824830543282,0.00777531892436066,0.00815066316583681,0.00853422428295076,0.00892594428651289,0.00932576395382168,0.00973362283761731,0.0101494592752205,0.0105732103978551,0.0110048121401529,0.0114441992498394,0.0118913052975993,0.0123460626871194,0.0128084026653086,0.0132782553326918,0.0137555496539787,0.0142402134688022,0.0147321735026292,0.0152313553778379,0.015737683624963,0.0162510816941057,0.0167714719665068,0.0172987757662816,0.0178329133723149,0.0183738040303136,0.0189213659650155,0.0194755163925525,0.0200361715329669,0.0206032466228774,0.0211766559282941,0.0217563127575805,0.02234212947456,0.0229340175117655,0.0235318873838291,0.0241356487010117,0.024745210182868,0.0253604796720475,0.025981364148227,0.0266077697421741,0.0272396017499392,0.0278767646471729,0.0285191621035687,0.029166696997426,0.0298192714303342,0.0304767867419735,0.0311391435250307,0.0318062416402284,0.0324779802314649,0.0331542577410618,0.0338349719251185,0.0345200198689699,0.035209298002746,0.0359027021170297,0.0366001273786123,0.0373014683463425,0.0380066189870682,0.0387154726916664,0.039427922291162,0.0401438600729297,0.0408631777969785,0.0415857667123168,0.0423115175733934,0.0430403206566143,0.0437720657769314,0.0445066423045007,0.0452439391814082,0.0459838449384604,0.0467262477120369,0.0474710352610023,0.0482180949836762,0.0489673139348564,0.0497185788428949,0.0504717761268231,0.0512267919135238,0.0519835120549467,0.0527418221453667,0.05350160753868,0.0542627533657373,0.0550251445517104,0.0557886658334898,0.0565532017771109,0.0573186367952063,0.0580848551644807,0.0588517410432069,0.0596191784887394,0.0603870514750433,0.0611552439102361,0.0619236396541387,0.0626921225358347,0.0634605763712336,0.0642288849806364,0.0649969322063001,0.0657646019299994,0.0665317780905823,0.0672983447015165,0.0680641858684256,0.0688291858066101,0.0695932288585529,0.070356199511405,0.0711179824144494,0.0718784623965408,0.0726375244835174,0.073395053915584,0.0741509361646617,0.0749050569517031,0.0756573022639698,0.0764075583722696,0.0771557118481506,0.0779016495810501,0.0786452587953954,0.079386427067654,0.0801250423433304,0.0808609929539073,0.0815941676337281,0.0823244555368191,0.0830517462536477,0.0837759298278147,0.0844968967726784,0.0852145380879075,0.0859287452759602,0.0866394103584879,0.0873464258926597,0.0880496849874066,0.0887490813195817,0.0894445091500349,0.0901358633395992,0.0908230393649867,0.09150593333459,0.0921844420041906,0.0928584627925671,0.093527893797004,0.0941926338086988,0.0948525823280625,0.0955076395799143,0.096157706528566,0.0968026848927949,0.0974424771607029,0.0980769866044582,0.0987061172949201,0.0993297741161413,0.0999478627797492,0.1005602898392,0.101166962703906,0.101767789653238,0.102362679850385,0.102951543356096,0.103534291142268,0.104110835105417,0.104681088079988,0.105244963851538,0.105802377169771,0.106353243761425,0.106897480343012,0.107435004633414,0.107965735366315,0.108489592302496,0.10900649624196,0.109516369035908,0.110019133598555,0.110514713918781,0.111003035071628,0.111484023229622,0.111957605673939,0.112423710805398,0.112882268155284,0.113333208396003,0.113776463351565,0.11421196600789,0.114639650522938,0.115059452236666,0.115471307680802,0.115875154588442,0.116270931903462,0.116658579789751,0.117038039640255,0.117409254085841,0.117772167003967,0.118126723527167,0.118472870051351,0.118810554243901,0.119139725051593,0.119460332708305,0.119772328742551,0.1200756659848,0.120370298574616,0.120656181967583,0.120933272942048,0.121201529605649,0.12146091140165,0.121711379115075,0.121952894878635,0.122185422178453,0.122408925859586,0.122623372131336,0.122828728572362,0.123024964135584,0.12321204915287,0.123389955339526,0.123558655798574,0.123718125024813,0.12386833890868,0.124009274739892,0.12414091121088,0.124263228420014,0.124376207874604,0.124479832493706,0.124574086610694,0.124658955975637,0.124734427757448,0.124800490545829,0.124857134352988,0.124904350615159,0.124942132193889,0.124970473377121,0.124989369880055,0.124998818845799,0.124998818845799,0.124989369880055,0.124970473377121,0.124942132193889,0.124904350615159,0.124857134352988,0.124800490545829,0.124734427757448,0.124658955975637,0.124574086610694,0.124479832493706,0.124376207874604,0.124263228420014,0.12414091121088,0.124009274739892,0.12386833890868,0.123718125024813,0.123558655798574,0.123389955339526,0.12321204915287,0.123024964135584,0.122828728572362,0.122623372131336,0.122408925859586,0.122185422178453,0.121952894878635,0.121711379115075,0.12146091140165,0.121201529605649,0.120933272942048,0.120656181967583,0.120370298574616,0.1200756659848,0.119772328742551,0.119460332708305,0.119139725051593,0.118810554243901,0.118472870051351,0.118126723527167,0.117772167003967,0.117409254085841,0.117038039640255,0.116658579789751,0.116270931903462,0.115875154588442,0.115471307680802,0.115059452236666,0.114639650522938,0.11421196600789,0.113776463351565,0.113333208396003,0.112882268155284,0.112423710805398,0.111957605673939,0.111484023229622,0.111003035071628,0.110514713918781,0.110019133598555,0.109516369035908,0.10900649624196,0.108489592302496,0.107965735366315,0.107435004633414,0.106897480343012,0.106353243761425,0.105802377169771,0.105244963851538,0.104681088079988,0.104110835105417,0.103534291142268,0.102951543356096,0.102362679850385,0.101767789653238,0.101166962703906,0.1005602898392,0.0999478627797492,0.0993297741161413,0.0987061172949201,0.0980769866044582,0.0974424771607029,0.096802684892795,0.096157706528566,0.0955076395799143,0.0948525823280625,0.0941926338086988,0.0935278937970041,0.0928584627925671,0.0921844420041906,0.09150593333459,0.0908230393649866,0.0901358633395993,0.0894445091500349,0.0887490813195817,0.0880496849874066,0.0873464258926598,0.0866394103584879,0.0859287452759602,0.0852145380879074,0.0844968967726784,0.0837759298278147,0.0830517462536477,0.0823244555368192,0.0815941676337281,0.0808609929539073,0.0801250423433304,0.079386427067654,0.0786452587953954,0.07790164958105,0.0771557118481506,0.0764075583722697,0.0756573022639699,0.0749050569517031,0.0741509361646617,0.073395053915584,0.0726375244835174,0.0718784623965408,0.0711179824144495,0.070356199511405,0.0695932288585529,0.0688291858066101,0.0680641858684256,0.0672983447015166,0.0665317780905823,0.0657646019299994,0.0649969322063,0.0642288849806364,0.0634605763712337,0.0626921225358347,0.0619236396541388,0.0611552439102361,0.0603870514750434,0.0596191784887394,0.0588517410432069,0.0580848551644807,0.0573186367952063,0.0565532017771109,0.0557886658334899,0.0550251445517105,0.0542627533657374,0.05350160753868,0.0527418221453667,0.0519835120549467,0.0512267919135237,0.0504717761268231,0.0497185788428949,0.0489673139348564,0.0482180949836762,0.0474710352610023,0.0467262477120369,0.0459838449384605,0.0452439391814082,0.0445066423045006,0.0437720657769315,0.0430403206566143,0.0423115175733934,0.0415857667123168,0.0408631777969785,0.0401438600729297,0.0394279222911621,0.0387154726916665,0.0380066189870682,0.0373014683463425,0.0366001273786123,0.0359027021170297,0.035209298002746,0.0345200198689699,0.0338349719251184,0.0331542577410618,0.0324779802314649,0.0318062416402285,0.0311391435250307,0.0304767867419735,0.0298192714303343,0.029166696997426,0.0285191621035687,0.027876764647173,0.0272396017499392,0.0266077697421741,0.025981364148227,0.0253604796720475,0.024745210182868,0.0241356487010117,0.0235318873838292,0.0229340175117655,0.02234212947456,0.0217563127575805,0.0211766559282941,0.0206032466228774,0.0200361715329669,0.0194755163925525,0.0189213659650155,0.0183738040303137,0.0178329133723149,0.0172987757662816,0.0167714719665068,0.0162510816941057,0.015737683624963,0.0152313553778379,0.0147321735026293,0.0142402134688022,0.0137555496539787,0.0132782553326918,0.0128084026653086,0.0123460626871194,0.0118913052975993,0.0114441992498394,0.0110048121401529,0.0105732103978551,0.0101494592752205,0.00973362283761733,0.00932576395382169,0.00892594428651291,0.00853422428295075,0.00815066316583685,0.00777531892436067,0.00740824830543282,0.00704950680510534,0.00669914866018159,0.00635722684001633,0.00602379303850755,0.00569889766628107,0.00538258984306904,0.00507491739028378,0.00477592682378782,0.00448566334686141,0.00420417084336826,0.003931491871121,0.00366766765544706,0.00341273808295581,0.00316674169550844,0.00292971568439077,0.00270169588469062,0.00248271676987986,0.00227281144660271,0.00207201164967016,0.00188034773726242,0.00169784868633903,0.00152454208825785,0.00136045414460382,0.00120560966322749,0.00106003205449452,0.00092374332774621,0.00079676408797217,0.000679113532694967,0.000570809449067844,0.000471868211185431,0.000382304777608318,0.00030213268910146,0.000231364066587018,0.000170009609311808,0.000118078593229792,0.0000755788695996074,0.0000425168637976092,0.0000188975743464284,0.00000472457215926203,0}

const double HANN_REDUCED[] = HANN_WINDOW_512_REDUCED; //SCALED DOWN BY 32

///// EQUALIZER

//Table for 256 spectrumSize (512 fftSize)

  #define EQUALIZER_256 {0.99944472020062,0.99944472020062,0.99944472020062,0.791691845437474,0.791691845437474,0.791691845437474,0.806874263578552,0.806874263578552,0.806874263578552,0.782391870292537,0.782391870292537,0.782391870292537,0.764008032973381,0.764008032973381,0.764008032973381,0.740836694406232,0.740836694406232,0.740836694406232,0.662813044723655,0.662813044723655,0.662813044723655,0.611065166756965,0.611065166756965,0.611065166756965,0.520677017563484,0.520677017563484,0.520677017563484,0.433648165790253,0.433648165790253,0.433648165790253,0.402717034325459,0.400405468330546,0.400405468330546,0.373680125382116,0.367456667203267,0.367456667203267,0.367705393378215,0.367705393378215,0.367705393378215,0.359534111407157,0.355802274039972,0.352297625781609,0.34901419582051,0.345946424091544,0.343089145597823,0.340437575927183,0.337987297906512,0.335734249341827,0.333674711796481,0.331805300364099,0.330122954396886,0.328624929153728,0.327308788336203,0.326172397484063,0.325213918205129,0.324431803217763,0.323824792187179,0.323391908339925,0.32313245584379,0.323046017943297,0.32313245584379,0.323391908339925,0.32382479218718,0.324431803217763,0.325213918205129,0.323738169086782,0.324779177396242,0.323391908339925,0.324692298997894,0.323391908339925,0.322096725738533,0.320806730335484,0.319521901356081,0.318242218108827,0.316967659985098,0.318924076738664,0.321064315438612,0.323391908339925,0.322355346616686,0.321322107364351,0.320292179933469,0.319265553708725,0.322096725738533,0.321150223092037,0.320206501806506,0.323391908339925,0.322527875888645,0.321666151943106,0.320806730335484,0.319949604914438,0.319094769545058,0.318242218108827,0.317391944503575,0.316543942643437,0.314854729896291,0.314854729896291,0.307876496099889,0.307876496099889,0.307876496099889,0.313916271389929,0.313916271389929,0.313916271389929,0.321084500271999,0.321084500271999,0.321084500271999,0.286182576041339,0.286182576041339,0.286182576041339,0.239482390696028,0.239482390696028,0.239482390696028,0.203592223809067,0.203592223809067,0.203592223809067,0.1993214258075,0.1993214258075,0.1993214258075,0.173421104726997,0.173421104726997,0.173421104726997,0.162462756050898,0.162462756050898,0.162462756050898,0.154442744054414,0.154442744054414,0.154442744054414,0.162557143503298,0.162557143503298,0.162557143503298,0.154139135132832,0.154139135132832,0.154139135132832,0.15697314489965,0.15697314489965,0.15697314489965,0.187846651771955,0.187846651771955,0.187846651771955,0.179904900185986,0.179904900185986,0.179904900185986,0.20127170175393,0.20127170175393,0.20127170175393,0.216756542147008,0.216756542147008,0.216756542147008,0.228911748756275,0.228911748756275,0.228911748756275,0.23984875408568,0.23984875408568,0.23984875408568,0.251379442523248,0.251379442523248,0.251379442523248,0.270319152447248,0.270319152447248,0.270319152447248,0.290508593675112,0.290508593675112,0.290508593675112,0.321140074158077,0.321140074158077,0.321140074158077,0.345147669966558,0.345147669966558,0.345147669966558,0.41635648232466,0.41635648232466,0.41635648232466,0.495075049751057,0.495075049751057,0.495075049751057,0.528201180096559,0.528201180096559,0.528201180096559,0.469953842903717,0.469953842903717,0.469953842903717,0.477037018994246,0.477037018994246,0.477037018994246,0.475322210052277,0.475322210052277,0.475322210052277,0.417864108903507,0.417864108903507,0.417864108903507,0.402016972133253,0.402016972133253,0.402016972133253,0.437008241675398,0.437008241675398,0.437008241675398,0.456826967994132,0.456826967994132,0.456826967994132,0.490968754638594,0.490968754638594,0.490968754638594,0.514222874090816,0.514222874090816,0.514222874090816,0.497511485534609,0.497511485534609,0.497511485534609,0.511219059235035,0.511219059235035,0.511219059235035,0.483774164217154,0.483774164217154,0.483774164217154,0.464262505496569,0.464262505496569,0.464262505496569,0.452826913887372,0.452826913887372,0.452826913887372,0.401219545565618,0.401219545565618,0.401219545565618,0.365331086170239,0.365331086170239,0.365331086170239,0.360903517452142,0.360903517452142,0.360903517452142,0.346880767326573,0.346880767326573,0.346880767326573,0.330530054676104,0.330530054676104,0.330530054676104,0.316352067750272,0.316352067750272,0.316352067750272,0.311288291773032,0.311288291773032,0.311288291773032,0.286594088045376,0.286594088045376,0.286594088045376,0.272890715662769,0.272890715662769,0.272890715662769,0.264896498560983,0.264896498560983,0.264896498560983,0.248666016452374,0.248666016452374,0.248666016452374,0.224274197399769,0.224274197399769,0.224274197399769,0.224274197399769}

const double EQUALTAB[] = EQUALIZER_256;
const int EQUALTABSIZE = 256;
const int EQUALTABSAMPLERATE = 44100;

///// AFSK
const double THRESHOLD_DETECT = 40;
